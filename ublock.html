<!DOCTYPE html>
<html lang="tr" oncontextmenu="return false" onselectstart="return false" ondragstart="return false">
<head>
    <meta charset="UTF-8">
    <title>UBlock Test</title>
    <script type="module" src="cookie.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXX-Y"></script>
    <script async src="https://static.doubleclick.net/instream/ad_status.js"></script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script>
    <meta name="referrer" content="always">
    <style>
        .reklam {width: 300px; height: 250px; background: #eee; margin: 20px;}
        .popup {position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                background: white; padding: 20px; display: none; z-index: 999;}
        .takip {position: fixed; bottom: 20px; right: 20px;}
        #analytics, .ads, .adsbygoogle, .ad-unit {display: none;}
        .sosyal {margin: 20px;}
        #adblockuyari {display: none; background: red; color: white; padding: 20px; text-align: center;}
        body * {user-select: none !important;}
        #gizliReklam {position: absolute; opacity: 0; pointer-events: none;}
    </style>
</head>
<body>
<div id="adblockuyari">Reklam engelleyicinizi kapatın!</div>
<div class="reklam" id="reklam1">
    <ins class="adsbygoogle"></ins>
</div>
<div class="reklam" id="reklam2">
    <amp-ad width="100" height="100" type="adsense"></amp-ad>
</div>
<div id="gizliReklam">
    <iframe src="about:blank" name="ad-frame" class="ad-frame"></iframe>
    <div class="ad-unit"></div>
    <div class="advertisement"></div>
</div>
<div class="popup" id="popup1">
    <h3>Bültenimize Abone Olun!</h3>
    <input type="email" placeholder="E-posta">
    <button onclick="this.parentElement.style.display='none'">Kapat</button>
</div>
<div class="takip">
    <button id="konumBtn">Konum İzni Ver</button>
</div>
<div class="sosyal">
    <iframe src="https://www.facebook.com/plugins/like.php" width="100" height="20"></iframe>
    <iframe src="https://platform.twitter.com/widgets/follow_button.html" width="100" height="20"></iframe>
    <iframe src="https://www.linkedin.com/embed/feed/update/" width="100" height="20"></iframe>
</div>

<script type="module">
import CerezYonetici from './cookie.js';

const Guvenlik = {
    konsoluKapat() {
        const metodlar = ['log', 'warn', 'error', 'info', 'debug', 'trace'];
        metodlar.forEach(metod => console[metod] = () => {});
    },

    devAraclariKontrol() {
        const element = new Image();
        Object.defineProperty(element, 'id', {
            get: () => {
                this.devAraclarAcik = true;
                return '';
            }
        });
        console.log('%c', element);
    },

    klavyeKontrol(e) {
        const yasakliTuslar = [
            e.ctrlKey && e.shiftKey && e.keyCode === 73,  // Ctrl+Shift+I
            e.ctrlKey && e.shiftKey && e.keyCode === 74,  // Ctrl+Shift+J
            e.keyCode === 123,                            // F12
            e.ctrlKey && e.keyCode === 85,               // Ctrl+U
            e.ctrlKey && e.keyCode === 83,               // Ctrl+S
            e.ctrlKey && e.keyCode === 80                 // Ctrl+P
        ];
        if(yasakliTuslar.some(kontrol => kontrol)) {
            e.preventDefault();
            return false;
        }
    },

    boyutKontrol() {
        const threshold = 160;
        if(this.devAraclarAcik || 
           window.outerWidth - window.innerWidth > threshold || 
           window.outerHeight - window.innerHeight > threshold) {
            window.location.href = "about:blank";
        }
    },

    init() {
        this.devAraclarAcik = false;
        this.konsoluKapat();
        setInterval(() => this.devAraclariKontrol(), 100);
        setInterval(() => this.boyutKontrol(), 100);
        document.addEventListener('keydown', this.klavyeKontrol);
        document.addEventListener('contextmenu', e => e.preventDefault());
        window.addEventListener('resize', () => {
            if(window.innerWidth < 50 || window.innerHeight < 50) {
                window.location.reload();
            }
        });
    }
};

const ReklamKontrol = {
    engellendi: false,

    kontrol() {
        const kontroller = [
            !!window.google_ad_status,
            !!window.google_ad_block,
            document.getElementById('gizliReklam').offsetHeight === 0,
            window.canRunAds === undefined,
            document.createElement('div').setAttribute('class', 'adsbygoogle')
        ];
        return kontroller.some(check => check);
    },

    rastgeleReklamYukle() {
        const reklamTipleri = ['adsense', 'doubleclick', 'analytics'];
        const rastgele = Math.floor(Math.random() * reklamTipleri.length);
        const element = document.createElement('script');
        element.src = `https://${reklamTipleri[rastgele]}.com/ads.js`;
        document.head.appendChild(element);
    },

    init() {
        setInterval(() => {
            if(this.kontrol()) {
                this.engellendi = true;
                document.getElementById('adblockuyari').style.display = 'block';
                this.rastgeleReklamYukle();
            }
        }, 500);
    }
};

const Analitik = {
    init() {
        window.dataLayer = window.dataLayer || [];
        window.gtag = function(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-XXXXX-Y');
    }
};

document.addEventListener('DOMContentLoaded', () => {
    // Güvenlik başlat
    Guvenlik.init();
    
    // Reklam kontrolü başlat
    ReklamKontrol.init();
    
    // Analitik başlat
    Analitik.init();
    
    // Çerez yönetimi başlat
    CerezYonetici.oturumBaslat();
    
    // Popup kontrolü
    setTimeout(() => {
        document.getElementById('popup1').style.display = 'block';
        
        // Ziyaretçi bilgilerini güvenli şekilde sakla
        CerezYonetici.depo.kaydet('ziyaret_detay', {
            tarih: new Date().toISOString(),
            tarayici: btoa(navigator.userAgent),
            ekran: `${window.innerWidth}x${window.innerHeight}`,
            dil: navigator.language
        });
    }, 3000);
    
    // Konum izleme
    document.getElementById('konumBtn').addEventListener('click', () => {
        navigator.geolocation.getCurrentPosition(konum => {
            CerezYonetici.depo.kaydet('konum_izin', {
                tarih: new Date().toISOString(),
                durum: 'izinVerildi'
            });
        });
    });
});

// Anti-debug
(function() {
    debugger;
    setInterval(() => {debugger;}, 100);
})();
</script>
</body>
</html>